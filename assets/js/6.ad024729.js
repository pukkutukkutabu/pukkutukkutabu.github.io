(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{174:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[t._v("Разлисные сниппеты для postgres (9.6, 11)")]),t._v(" "),t._m(1),t._v(" "),a("p",[t._v("Репликация состоит из 2х шагов, создание слота репликации на сервере с которого она будет осуществляться и репликации (копирования) данных на новую реплику с помощью программы pg_basebackup")]),t._v(" "),a("p",[t._v("На сервере с которого будет осуществяться репликация (мастер или реплика):")]),t._v(" "),t._m(2),a("p",[t._v("На новом сервере:")]),t._v(" "),t._m(3),a("p",[t._v("где "+t._s(t.ip_address)+" - ip адрес сервера")]),t._v(" "),a("p",[t._v("опции:")]),t._v(" "),t._m(4)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"postgres"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#postgres","aria-hidden":"true"}},[this._v("#")]),this._v(" Postgres")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"репnикация"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#репnикация","aria-hidden":"true"}},[this._v("#")]),this._v(" Репликация")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[this._v("SELECT")]),this._v(" pg_create_physical_replication_slot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[this._v("'slot_name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v(";")]),this._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#basebackup from postgres user (centos)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("time")]),t._v(" pg_basebackup -P -R -X stream -S "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'slot_name'")]),t._v(" -c fast -h "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("ip_address"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" -U postgres -D /var/lib/pgsql/9.6/data/ -p 5432\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("p",[t._v("-P -")])]),t._v(" "),a("li",[a("p",[t._v("-X - тип репликации (в данном случае stream)")])]),t._v(" "),a("li",[a("p",[t._v("-S - имя слота")])]),t._v(" "),a("li",[a("p",[t._v("-c fast - не дожидаться следующего checkpoint'a на сервере, а сделать сразу")])]),t._v(" "),a("li",[a("p",[t._v("-R - создавать recovery.conf (перетирает если на сервере уже имеется)")])])])}],!1,null,null,null);s.default=n.exports}}]);